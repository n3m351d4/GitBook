---
description: June 20, 2018
cover: >-
  https://images.unsplash.com/photo-1610337673044-720471f83677?crop=entropy&cs=srgb&fm=jpg&ixid=MnwxOTcwMjR8MHwxfHNlYXJjaHw2fHxzaWduYWx8ZW58MHx8fHwxNjM5MjM1NTAx&ixlib=rb-1.2.1&q=85
coverY: 0
---

# Информационная безопасность в системах подвижной связи. Доклад.

**Вступление.**

Существует большое количество видов и стандартов подвижной связи, наиболее близкие и известные нам – это GSM, LTE, 3G, спутниковая связь, а также хотелось бы отметить широко применяемые стандарты Bluetooth и Wi-Fi.

Эти два стандарта, как известно очень широко используются для передачи данных в Интернете вещей, то есть не только для передачи информации между абонентами, но и для передачи информации между системами автоматики, датчиками и компьютерными системами.

Конечно, в связи с тем, что эти стандарты очень распространены, над безопасностью передачи данных с их помощью постоянно ведется работа, но несмотря на это – для них существует наибольшее количество способов перехвата как обычных данных, так и авторизационных данных.

В плане информационной безопасности, практически все системы подвижной связи уязвимы к атакам типа Man In The Middle, например, с использованием Evil Twin базовой станции.

Man In The Middle - атака «человек посередине» — вид атаки в криптографии, когда злоумышленник перехватывает и подменяет сообщения, которыми обмениваются корреспонденты, причём ни один из последних не догадывается о его присутствии в канале.

Evil Twin - «злой двойник» — Атакующий создает копию беспроводной точки доступа, находящейся в радиусе приема пользователя, тем самым подменяет оригинальную точку доступа двойником, к которому подключается пользователь, открывая злоумышленнику возможность доступа к конфиденциальной информации.

Эти способы сводят на нет вообще смысл совершенствования текущих систем шифрования в гражданских сетях подвижной связи, в том числе из-за доступности для домашней сборки многих модулей и антенных устройств.

В данном докладе я постараюсь рассмотреть виды шифрования и методы аутентификации и идентификации, использующиеся в стандарте GSM, который, каждый желающий может прослушивать, используя оборудование за 100 долларов из Китая.

Относительно, LTE сетей, я могу сказать, что знаю на данный момент лишь то, что создание поддельной базовой станции LTE – реально в домашних условиях, но ее использование приводит к отключению абонента от самой сети связи, приводя к переподключению к базовой станции по стандарту 2G\3G, что уже позволяет осуществить атаку с перехватом данных.

&#x20;**1.    Симметричные системы шифрования.**

В симметричной криптосистеме шифрования используется один и тот же ключ для шифрования и расшифровки сообщения. Это означает, что любой, кто имеет доступ к ключу шифрования, может расшифровать сообщение. Именно поэтому симметричные криптосистемы называют криптосистемами с секретным ключом - ключ шифрования должен быть доступен только тем, кому предназначено сообщение.

Задача обеспечения конфиденциальности передачи электронных документов с помощью симметричной криптосистемы сводится к обеспечению конфиденциальности ключа шифрования. Обычно ключ шифрования представляет собой файл или массив данных и хранится на персональном ключевом носителе, например, на дискете или смарт-карте; обязательно принятие мер, обеспечивающих недоступность персонального ключевого носителя кому-либо, кроме его владельца.

Симметричное шифрование идеально подходит для шифрования информации для себя, например, с целью предотвратить несанкционированный доступ к ней в отсутствие владельца. Это может быть, как архивное шифрование выбранных файлов, так и прозрачное (автоматическое) шифрование целых логических или физических дисков.

При симметричном шифровании перед тем, как начать обмениваться зашифрованными данными, нужно передать и принять секретные ключи от всех адресатов. В симметричных криптосистемах нельзя передавать по легко доступным каналам связи секретный ключ, - его необходимо передавать отравителю и получателю только по защищенным каналам передачи данных.

Симметричные криптосистемы делятся следующих на два типа:

1\. блочные криптосистемы - разбивают информацию (файл / сообщение / документ) на отдельные блоки, а после этого преобразовывают данные блоки, используя секретный ключ;

2\. поточные криптосистемы - на основе секретного ключа создают определенную последовательность (выходная гамма), накладываемую на исходную информацию. Поэтому преобразование данных выполняется в потоке по мере создания выходной гаммы и данный тип криптосистем в основном применяется для шифрования в средствах связи. (например, шифрование голосового сообщения)

**2.    Несимметричные системы шифрования.**

Принципиальное отличие асимметричной криптосистемы от криптосистемы симметричного шифрования состоит в том, что для шифрования информации и ее последующего расшифрования используются различные ключи:

1\. открытый ключ К - используется для шифрования информации, вычисляется из секретного ключа k;

2\. секретный ключ k - используется для расшифрования информации, зашифрованной с помощью парного ему открытого ключа К.

Секретный и открытый ключи генерируются попарно. Секретный ключ должен оставаться у его владельца - его необходимо надежно защитить от несанкционированного доступа (аналогично ключу шифрования в симметричных алгоритмах). Копия открытого ключа должна находиться у каждого абонента криптографической сети, с которым обменивается информацией владелец секретного ключа.

Процесс передачи зашифрованной информации в асимметричной криптосистеме осуществляется следующим образом:

1\. Подготовительный этап - абонент В генерирует пару ключей:

\- секретный ключ kв и открытый ключ Кв;

\- открытый ключ Кв посылается абоненту А и остальным абонентам (или делается доступным, например, на разделяемом ресурсе);

2\. Использование - обмен информацией между абонентами А и В:

\- абонент А зашифровывает сообщение с помощью открытого ключа Кв абонента В и отправляет шифр-текст абоненту В;

\- абонент В расшифровывает сообщение с помощью своего секретного ключа kв. Никто другой (в том числе абонент А) не может расшифровать данное сообщение, так как не имеет секретного ключа абонента В.

Защита информации в асимметричной криптосистеме основана на секретности ключа kв получателя сообщения.

Отметим характерные особенности асимметричных криптосистем:

1\. Открытый ключ Кв и криптограмма С могут быть отправлены по незащищенным каналам, то есть противнику известны Кв и С.

![](https://telegra.ph/file/7f36551aea4baee5ba7f0.png)

2\. Алгоритмы шифрования и расшифрования:

Ев: М -+ С, Dв: С -+ М - являются открытыми.

У Диффи и М. Хеллман сформулировали требования, выполнение которых обеспечивает безопасность асимметричной криптосистемы:

1\. Вычисление пары ключей (Кв, kв) получателем В на основе начального условия должно быть простым.

2\. Отправитель А, зная открытый ключ Кв и сообщение М, может легко вычислить криптограмму.

3\. Получатель В, используя секретный ключ kв и криптограмму С, может легко восстановить исходное сообщение: M = Dkв (C).

4\. Противник, зная открытый ключ Кв, при попытке вычислить секретный ключ kв наталкивается на непреодолимую вычислительную проблему.

5\. Противник, зная пару (Кв, С), при попытке вычислить исходное сообщение М наталкивается на непреодолимую вычислительную проблему.

**Методы шифрования в GSM**

Система GSM построена на алгоритмах шифрования с открытым ключом, суть которых заключается в наличии у каждой стороны секретного и открытого ключа, при этом секретный не может быть выведен из открытого. Расшифровка сообщения, зашифрованного при помощи открытого ключа возможна, только если известен секретный ключ.

Также используются симметричные алгоритмы, суть которых заключается в наличии сеансового ключа, который используется как для шифрования, так и расшифрования сообщений. &#x20;

**3.    Идентификация в системах подвижной связи.**

**Идентификация** – процедура отождествления подвижной станции (абонентского радиотелефонного аппарата), т.е. процедура установления принадлежности к одной из групп, обладающих определенными свойствами или признаками. Эта процедура используется для выявления утерянных, украденных или неисправных аппаратов. Слово идентификация (английское identification) происходит от средневекового латинского identificare – отождествлять.

**Процедура идентификации** заключается в сравнении идентификатора абонентского аппарата с номерами, содержащимися в соответствующих «черных списках» регистра аппаратуры, с целью изъятия из обращения украденных и технически неисправных аппаратов. Идентификатор аппарата делается таким, чтобы его изменение или подделка были трудными и экономически невыгодными. В принципе может быть целесообразен и оперативный обмен информацией между регистрами аппаратуры – межоператорский и международный, в интересах объединения усилий операторов в борьбе с фродом в сотовой связи

Первоначально, в аналоговых системах сотовой связи первого поколения, процедура аутентификации имела простейший вид: подвижная станция передавала свой уникальный идентификатор (электронный серийный номер – Electronic Serial Number, ESN), и если таковой отыскивался среди зарегистрированных в домашнем регистре, то процедура аутентификации считалась успешно выполненной.

В стандарте GSM процедура аутентификации связана с использованием модуля идентификации абонента - SIM-картой или смарт-картой. Модуль содержит персональный идентификационный номер абонента– PIN, международный идентификатор абонента подвижной связи (International Mobile Subscriber Identity – IMSI), индивидуальный ключ аутентификации абонента Ki, индивидуальный алгоритм аутентификации абонента A3, алгоритм вычисления ключа шифрования А8.

Одной из главных задач сети GSM является определение местоположения абонента. Для этого используются специальные идентификаторы, представляющие собой некоторые уникальные номера.

&#x20;Давайте рассмотрим каждый идентификатор. В дальнейшем это будет необходимо для понимания основных процессов, происходящих в сети GSM.

**IMSI (International Mobile Subscriber Identify)** – идентификатор, однозначно определяющий в сети каждого абонента мобильной связи стандарта GSM (а также UMTS или CDMA). Этот номер необходим для выполнения таких основных процедур, как аутентификация абонента, шифрование/дешифрование передаваемых данных. IMSI состоит из:

• MCC (Mobile Country Code) – код мобильной связи страны

&#x20;• MNC (Mobile Network Code) – код оператора мобильной связи

&#x20;• MSIN (Mobile Station Identification Number) – идентификатор мобильной станции

IMSI обычно состоит из 15 цифр.

![](https://telegra.ph/file/57e248aaaf7d67364ab11.png)

&#x20;**MSISDN (Mobile Station ISDN Number)** – номер, который вы набираете для вызова какого-либо абонента (например, +7 9хх ххх хххх). Вот его составные части:

• CC (Country Code) – код страны

&#x20;• NDC (National Destination Code) – национальный код места назначения (сети либо города)

&#x20;• SN (Subscriber Number) – номер абонента

Свой NDC есть у каждой сети PLMN. А в России их даже несколько на каждого оператора. MSISDN может быть до 15 цифр длиной, не считая префиксов типа (+7).

![](https://telegra.ph/file/2e5bc7d20e4faeda12ea0.png)

&#x20;**Temporary Mobile Subscriber Identify (TMSI)** – это временный IMSI, который присваивается мобильной станции при ее регистрации в сети. Временный идентификатор используется в целях безопасности. Именно с использованием TMSI мобильная станция будет устанавливать соединение по радиоканалу. Данный идентификатор периодически меняется сетью и не имеет жесткой структуры (в отличие от IMSI). Длина его, как правило, в два раза меньше, что позволяет в одном цикле осуществлять пэйджинг для двух абонентов, а также уменьшать нагрузку на процессор.

&#x20;**IMEI (International Mobile Terminal Identify)** – однозначно определяет любую мобильную станцию в сети. Может использоваться для обнаружения краденого оборудования и блокировки ему доступа в сеть. Вот из чего, согласно спецификациям GSM, состоит IMEI:

• TAC (Type Approval Code) – код утвержденного типового образца

&#x20;• SNR (Serial Number) – серийный номер оборудования

&#x20;• CD – контрольное число

![](https://telegra.ph/file/5b72597011ab5027ce9cf.png)

&#x20;**IMEISV (International Mobile Terminal Identify and Software Version Number)** – с помощью этого идентификатора мобильной станции обеспечивается уникальная идентификация и соответствие установленного на ней программного обеспечения тому, которое разрешено оператором. Это, на самом деле, довольно важно. От версии ПО зависит список доступных мобильной станции услуг и ее возможности по речевому кодированию.

![](https://telegra.ph/file/161c113bcf3db501bddb4.png)

**MSRN (Mobile Station Roaming Number)** – временный номер мобильной станции, который используется для маршрутизации вызова на тот MSC, под управлением которого находится MS в данный момент. После применения по назначению для одного подвижного терминала MSRN может назначаться другим подвижным терминалам.

• SN – адрес управляющего MSC/VLR

![](https://telegra.ph/file/b5449299ea493d09eff14.png)

&#x20;**LAI (Location Area Identify)** – идентификатор зоны местоположения, который уникально описывает LA в сети GSM в масштабе всего мира.

• LAC (Location Area Code) – код зоны местоположения, максимальная длина которого – 16 бит. Это позволяет определить 65536 разных LA в пределах конкретной PLMN.

![](https://telegra.ph/file/8fa399fe84278e2380e76.png)

&#x20;**CGI (Cell Global Identify)** – глобальный идентификатор соты. С помощью него происходит определение соты в пределах зоны местоположения LA.

• CI (Cell Identify) – идентификатор соты&#x20;

![](https://telegra.ph/file/be8fc2f368283af6b1fb3.png)

&#x20;**BSIC (Base Station Identify Code)** – идентификатор базовой станции, позволяющий различать соты с одинаковыми частотами. В его состав входит:

• NCC (Network Color Code) – цветовой код сети, используемый для разграничения зон действия операторов в местах их пересечения

&#x20;• BCC (Base station Color Code) – цветовой код базовой станции. С его помощью различают базовые станции с одинаковыми частотами.

![](https://telegra.ph/file/d777047bc7f4381d84e15.png)

**4.    Аутентификация в системах подвижной связи (GSM)**

**Аутентификация** – процедура подтверждения подлинности (действительности, законности, наличия прав на пользование услугами сотовой связи) абонента системы подвижной связи. Необходимость введения этой процедуры вызвана неизбежным стремлением людей получения несанкционированного доступа к услугам сотовой связи, приводящим к многочисленным и разнообразным проявлениям мошенничества.

![](https://telegra.ph/file/ae5fbf08672be376c724f.png)

Рис.2.16. Схема процедуры аутентификации (стандарт GSM): R - случайное число; A3 - алгоритм аутентификации; А8 - алгоритм вычисления ключа шифрования; Ki - ключ аутентификации, Кс - ключ шифрования; S - зашифрованный отклик (Signed Response - SRES)

&#x20;**Суть аутентификации в GSM** — избежание клонирования мобильного телефона пользователя. Секретным ключом является 128-битный ключ Ki, которым обладает как абонент, так и Центр Аутентификации (AuC — Authentication Centre). Ki хранится в SIM-карте, также как и алгоритм A3. Также в аутентификации принимают участие Домашний реестр местоположения (HLR — Home Location Registry) и Центр коммутации (MSC — Mobile Switching Centre).

&#x20;**Основные определения:**

&#x20;**HLR (англ. Home Location Register) - Домашний реестр местоположения** — база данных, которая содержит информацию об абоненте сети GSM-оператора.

**Центр аутентификации (AuC, англ. Authentification Center)** - предназначен для аутентификации каждой SIM карты которая пытается присоединиться к GSM-сети (обычно, когда телефон включается). Также ей генерируется шифровальный ключ, который периодически используется для шифрования беспроводного соединения (голосового, SMS) между мобильным телефоном и базовой сетью.

**VLR (англ. Visitors Location Register)** — временная база данных абонентов, которые находятся в зоне действия определённого центра мобильной коммутации. Каждая базовая станция в сети приписана к определённому VLR, так что абонент не может присутствовать в нескольких VLR одновременно.

**Центр мобильной коммутации (MSC, англ. Mobile Switching Center)** — специализированная автоматическая телефонная станция, обеспечивающая возможность связи с коммутацией каналов, управления мобильностью и предоставления сервисов GSM для мобильных телефонов внутри зоны своего обслуживания. Это предполагает голос, данные и факсимильную связь, а также SMS и переадресацию вызовов.

**EIR (англ. Equipment Identity Register — реестр идентификации оборудования)** часто интегрирован с HLR.

![](https://telegra.ph/file/35d59e467f07a07c75a2c.png)

Когда мобильная станция (MS) запрашивает доступ к сети GSM (например при включении), Центр мобильной коммутации (MSC) должен проверить подлинность мобильной станции (MS). Для этого Центр мобильной коммутации (MSC) отправляет в базу данных (HLR) уникальный международный идентификатор абонента (IMSI — International Mobile Subscriber Identity) и запрос на получение набора специальных триплетов. Когда база данных (HLR) получает IMSI запрос на триплеты, он сначала проверяет свою базу данных, чтобы удостовериться, что мобильная станция (MS) с таким IMSI действительно принадлежит сети. Если проверка прошла успешно, то база данных (HLR) отправляет IMSI и запрос установления подлинности в Центр аутентификации (АuC).

Центр аутентификации (AuC) использует IMSI, чтобы найти Ki (ключ аутентификации) соответствующий этому IMSI. Также Центр аутентификации (AuC) генерирует случайное 128-битное число RAND. После этого Центр аутентификации (AuC) вычисляет 32-битный отзыв SRES (SRES — Signed Response) при помощи алгоритма A3: SRES = A3(RAND, Ki). Кроме того, Центр аутентификации (AUC) вычисляет 64-битный сеансовый ключ Kc при помощи алгоритма A8: Kc = A8(RAND, Ki). Kc в дальнейшем используется в алгоритме A5 для шифрования и расшифрования данных.

RAND, SRES, и Kc как раз образуют триплеты, которые Центр мобильной коммутации (MSC) запросил у базы данных (HLR). Центр аутентификации (AuC) генерирует пять таких триплетов и посылает их в БД (HLR), затем БД (HLR) пересылает этот набор в Центр коммутации (MSC). Генерируется именно набор триплетов, чтобы уменьшить передачу сигналов в GSM core network, которая происходила бы каждый раз, когда мобильная станция (MS) запрашивала бы доступ к сети, а коммутатор (MSC) должен был бы проверить подлинность MS. Следует отметить, что набор триплетов уникален для одного IMSI и не может быть использован для какого-либо другого IMSI.

&#x20;Коммутатор (MSC) сохраняет Kc и SRES и посылает запрос RAND мобильной станции MS абонента. Получив запрос RAND, мобильная станция (MS) вычисляет ответ на запрос SRES при помощи алгоритма A3 и секретного ключа Ki: SRES = A3(RAND, Ki), и посылает его в MSC. Если принятый SRES совпадает с SRES, хранящимся в коммутаторе (MSC), то аутентификация считается пройденной успешно.

&#x20;После пяти сессий аутентификации коммутатор (MSC) запрашивает у БД (HLR) новый набор триплетов (RAND, SRES, Kc)

**Заключение.**

В заключение очется сказать, что, несомненно, с появлением подвижной связи наша жизнь намного упростилась, беспроводная передача информации и ее обмен между мобильными устройствами через различные сети связи – несомненно является неотъемлемой частью жизни современного человека. Сверх этого, беспроводная связь охватывает и другие области, не гражданские, а специализированные для различных служб, хоть мы в повседневной жизни этого и не замечаем, но подобные виды связи являются огромным айсбергом, скрытым от обычного пользователя. Это, допустим, связь метеоспутников с метеоцентрами, военных, служб МЧС.

Но, не смотря на такое огромное количество преимуществ, подвижные виды связи – являются самыми уязвимыми к вторжению злоумышленника в информационную систему для перехвата или подменны передаваемых данных.

Не смотря, на то, что это кажется обычному человеку невозможным – на практике, имея даже небольшое представление о радиосвязи, с увеличением доступности Китайских радиодеталей и модулей – позволить себе собрать устройство, которое может скомпрометировать подвижную систему связи – может любой человек.

Каждый день в открытом доступе появляются новые микропрограммы для, например, контроллеров домашних спутниковых приемников, позволяющие переводить их в режим мониторинга передающихся данных и прослушивать спутниковый траффик абонентов, а если перехватить часть TCP траффика и верно ее переадресовать, то можно, вполне легко использовать оплаченный траффик спутникового интернета другого абонента от его имени.

Хотелось бы дать небольшие рекомендации слушателям моего доклада. Для того, чтобы обезопасить свои данные в сотовых сетях, обращайте внимание, к какой базовой станции подключаетесь, используйте специализированные программы и следите за новостями информационной безопасности.

[https://t.me/in51d3](https://t.me/in51d3)
