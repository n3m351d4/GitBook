---
description: 2021 @in51d3
---

# Hardware Hacking: Ломаем железо при помощи UART

> Перевела @ZzzNein \(безграничную благодарность можно выразить [ЗДЕСЬ](https://yasobe.ru/na/na_perevody_i_kontent)\), проверила @N3M351DA. [Оригинальный текст](https://www.blackhillsinfosec.com/gnu-radio-primer/) - Реймонд Фелч‌

## **Предисловие**

Я начал погружаться в мир обратного проектирования аппаратного обеспечения \(реверс-инжиниринга\) всего несколько недель назад \(см. «JTAG – Отладка микроконтроллера»\). Несмотря на то, что я добился значительных успехов в поиске распиновки \(маппинге\) JTAG на плате роутера Linksys BEFSR41 \(Samsung S3C4510 CPU\), я столкнулся с несколькими трудностями. У меня появились проблемы с извлечением прошивки с помощью OpenOCD и нескольких различных адаптеров JTAG \(включая использование самодельного Raspberry Pi3 в качестве адаптера JTAG и SWD \(см.: [https://movr0.com/2016/09/02/use-raspberry-pi-23-as-a-jtagswd-adapter](https://movr0.com/2016/09/02/use-raspberry-pi-23-as-a-jtagswd-adapter)\), который отлично работал и даже обошел скоростные ограничения Bus Pirate.

В некоторых случаях мне удавалось выгружать данные из флэш памяти, но данные оказывались поврежденными и плохо распознавались инструментом binwalk. Эта проблема могла быть связана с синхронизацией или отсутствием у устройства состояния ожидания перед считыванием памяти. Также, стало ясно, что время от времени производители могут принимать меры предосторожности для защиты данных, завязывая Reset на высокие логические уровни схемы либо блокируя пины JTAG с помощью соответствующих предохранителей \(fuses\) после тестирования устройства на стадии производства. Мой список неразгаданных вопросов пополнился в том числе, еще и потому, что я использовал старую плату в сомнительном состоянии.

Освоение и использование **OpenOCD** \(отладчик с открытым исходным кодом\) само по себе было большим делом. Как говорится в Wiki, «OpenOCD – бесплатное программное обеспечение для отладки систем на кристалле, внутрисистемного программирования и тестирования систем ARM и MIPS». Сервер OpenOCD принимает команды через порты TCP/IP и предоставляет интерфейс, позволяющий взаимодействовать с устройствами. Указанный интерфейс может работать через порт telnet 4444 или с использованием GDB \(отладчик GNU\) на порту 3333.

## Выбор нового роутера и подхода

После своего разочарования, я решил временно отдохнуть от этого проекта \(JTAG\) и попробовать другой, но схожий, подход к получению доступа к прошивке.

**Примечание**: прежде чем взяться за этот проект, я решил, что хочу начать работу с заведомо исправным устройством, поэтому купил новый роутер Linksys E2500 v3.

![](../../.gitbook/assets/image%20%28296%29.png)

Разбирается он довольно просто - открутите три винта снизу и подденьте крышку линейкой.

![](../../.gitbook/assets/image%20%28295%29.png)

![](../../.gitbook/assets/image%20%28294%29.png)

## Поиск контактов для доступа к UART

Как и в случае использования JTAG, я изучил плату на наличие групп контактов, которые могут дать доступ к последовательному интерфейсу \(TX RX GND\). Я сразу же увидел на плате зону с 5 контактами \(обозначенными JD6\), которые могли быть возможной точкой доступа к UART. Чтобы облегчить себе жизнь, я впаял 5-контактный разъем.

![](../../.gitbook/assets/image%20%28297%29.png)

![](../../.gitbook/assets/image%20%28298%29.png)

Я так же нашел на этой плате контакты JTAG \(они были четко промаркированы TDI, TDO, TCK и TMS\). Там же были контакты CPU \(BCN5358 MIPS\) и Broadcom Radio \(BCM43236\), что указывает на то, что вероятно для этой платы использовалось несколько отладчиков. К сожалению, контакты были настолько малы, что мне никак бы не удалось к ним подсоединиться даже при большом желании, что еще сильней оправдало избранный мною подход.

