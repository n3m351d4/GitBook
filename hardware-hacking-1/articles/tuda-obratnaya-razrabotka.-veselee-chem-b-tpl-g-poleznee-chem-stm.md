---
description: '2020'
---

# Туда-обратная разработка. Веселее, чем б\*тпл\*г, полезнее, чем STM

_Не рекомендуется к прочтению тем, кто обладает проблемами с нервной системой._

_Когда я кидала статью на утверждение, меня спросили: “А где же тут ИБ, это же схемотехника!” Хочу от себя заметить, что ИБ помимо сферы ИТ распространяется не только на стандартизацию, безопасность программного обеспечения, защиту от утечек информации по сторонним каналам \(сюда в том числе входит изучение распространения радиоволн и электромагнитных сигналов\), но и на аппаратный уровень._

_Википедия:_

* _**Обра́тная разрабо́тка** \(обратное проектирование, обратный инжиниринг, реверс-инжиниринг; англ. reverse engineering\) — исследование некоторого готового устройства или программы, а также документации на него с целью **понять принцип его работы**; например, чтобы обнаружить недокументированные возможности \(в том числе программные закладки\), **сделать изменение** или воспроизвести устройство, программу или иной объект с аналогичными функциями, но без прямого копирования._
* _**Схемоте́хника** — научно-техническое направление, занимающееся **проектированием, созданием и отладкой** \(синтезом и анализом\) электронных схем и устройств различного назначения._

_К сожалению, в данной статье мы ничего **проектировать и создавать** не будем. В том числе, заниматься **отладкой** \(синтезом и анализом\), в том варианте, в котором ей занимаются при создании и проектировании устройств, то есть перед их запуском в производство._

_В данной статье мы рассмотрим, как методом подбора комбинации логических значений можно научиться управлять проприентарным устройством для нарушения **целостности информации. Мы будем** использовать **недокументированные** возможности устройства, то есть **не предусмотренные инструкцией**._

Однажды \(тысячу лет назад\) мне в руки попался интереснейший девайс, я не смогла удержаться и разобрала его. Постараюсь описать самое интересное из того что я увидела внутри и подтолкнуть к определенным выводам тех, кто захочет развить данную тему.

Уточнять, что за устройство мы рассматриваем я не буду по этическим причинам.

Итак, перед нами сравнительно небольшая плата:

![](https://dc7495.org/aybbtu/uploads/2020/05/word-image.png)

Рассматриваемый нами девайс содержит дисплей, который имеет шесть выводов. Изображения, которые может выводить дисплей – фиксированные, то есть они заранее созданы и отображаются, когда на выводы дисплея поступает определенный набор сигналов с контролирующей микросхемой.

![](https://dc7495.org/aybbtu/uploads/2020/05/word-image-1.png)

С другой стороны мы можем увидеть:

– отсек с батарейками \(1\),

– пассивные компоненты,

– микросхему, залитую компаундом – для того, чтобы защитить ее от внешних воздействий и реверсеров \(2\),

– контакты датчика\(3\),

– кусок пластика с прорезями.

![](https://dc7495.org/aybbtu/uploads/2020/05/word-image-2.png)

После удаления куска пластика с прорезями мы можем наблюдать 4 светодиода и один фотодиод \(группа элементов справа\). Это удивительно, так как в корпусе как раз нет отверстий ни для первых, ни для второго. Можно предположить, что фотодиод служит для определения момента закрытия крышки корпуса, но опять же – достаточного отверстия для поступления света там нет.

Еще одним следствием работы фотодиода может быть то, что после разбора корпуса, при попадании на него света прошивка перестала вести себя статично и микросхема начала отправлять меандр на контакты дисплея, от чего тот начал мигать.

_Меандр – последовательность прямоугольных импульсов с равной длиной импульса и паузой, в логических устройствах может считываться как 0-1-0-1-0-1-0 и так далее._

![](https://dc7495.org/aybbtu/uploads/2020/05/GIF1-1.gif)

Чтобы определить на скорую руку на какие контакты приходит сигнал – меандр, был использован светодиод. Путем преставления ног светодиода между контактами \(одна – на земле, вторая на сигнальном контакте\) можно легко определить какие из контактов – «мерцают». Так же, это можно проделать с помощью мультиметра в режиме измерения постоянного тока.

![](https://dc7495.org/aybbtu/uploads/2020/05/GIF2.gif)

Так как отковыривать компаунд дело долгое и неблагодарное, а внесение изменений в прошивку данного девайса в срочном порядке вряд ли будет популярно, далее будет предложено простое и действенное изменение значения на дисплее нужное нам.

Практическим образом было установлено, что, если использовать постоянный сигнал с источника питания девайса, можно добиться фиксации изображения на экране. Эксперимент проводился с двумя контактами, но можно их припаивать и пробовать узнавать режимы работы дисплея с изменением большего количества информационных значений.

![](https://dc7495.org/aybbtu/uploads/2020/05/%D0%93%D0%B8%D1%84%D0%BA%D0%B03.gif)

Мы разобрались, что при закорачивании контактов 3 и 5 можно добиться специфической статической надписи. Для того, чтобы это проделать требуется:

* Разобрать корпус \(он крайне легко разбирается руками\).
* Кинуть минимум две перемычки от батарейки к контактам 3 и 5.

Если сделать это аккуратно, то можно легко справиться за 60 секунд. При учете специфических условий из данных нескольких минут, останется еще время на посидеть в мессенджере.

Отрицательный результат достигается закорачиванием 3 и 6 контакта соответственно, но здесь нас предательски выдает неверная надпись, под результатом, логически несовместимая с ним.

**TODO**:

\[+\] За счет пайки и использования оставшихся контактов добиться вывода на экране полностью статичной надписи.

Для этого потребуется создать таблицу значений.

Пример ее заполнения:

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>&#x41D;&#x43E;&#x43C;&#x435;&#x440; &#x432;&#x44B;&#x432;&#x43E;&#x434;&#x430;</b>
      </th>
      <th style="text-align:left"><b>1</b>
      </th>
      <th style="text-align:left"><b>2</b>
      </th>
      <th style="text-align:left"><b>3</b>
      </th>
      <th style="text-align:left"><b>4</b>
      </th>
      <th style="text-align:left"><b>5</b>
      </th>
      <th style="text-align:left"><b>6</b>
      </th>
      <th style="text-align:left"><b>&#x412;&#x44B;&#x432;&#x43E;&#x434;&#x438;&#x43C;&#x43E;&#x435; &#x438;&#x437;&#x43E;&#x431;&#x440;&#x430;&#x436;&#x435;&#x43D;&#x438;&#x435;</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">&#x421;&#x43E;&#x441;&#x442;&#x43E;&#x44F;&#x43D;&#x438;&#x435; &#x432;&#x44B;&#x432;&#x43E;&#x434;&#x43E;&#x432;
        (1)</td>
      <td style="text-align:left">?</td>
      <td style="text-align:left">1</td>
      <td style="text-align:left">?</td>
      <td style="text-align:left">?</td>
      <td style="text-align:left">1</td>
      <td style="text-align:left">?</td>
      <td style="text-align:left">
        <p>&#x411;&#x435;&#x440;&#x435;&#x43C;&#x435;&#x43D;&#x43D;&#x430; (&#x441;&#x442;&#x430;&#x442;&#x438;&#x447;&#x435;&#x441;&#x43A;&#x43E;&#x435;)</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x43E;&#x43A; &#x447;&#x430;&#x441;&#x44B;,
          &#x43A;&#x43D;&#x438;&#x436;&#x43A;&#x430; (&#x43C;&#x43E;&#x440;&#x433;&#x430;&#x44E;&#x442;)</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">&#x421;&#x43E;&#x441;&#x442;&#x43E;&#x44F;&#x43D;&#x438;&#x435; &#x432;&#x44B;&#x432;&#x43E;&#x434;&#x43E;&#x432;
        (2)</td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
      <td style="text-align:left"></td>
    </tr>
  </tbody>
</table>

\[-\] Возможно, полученные результаты усложнят процесс фальсификации, что недопустимо.

![](https://dc7495.org/aybbtu/uploads/2020/05/word-image-3.png)

![](https://dc7495.org/aybbtu/uploads/2020/05/word-image-4.png)

_Также чтобы определить вектор развития событий скажу: в данной статье мы с вами рассмотрели исследование и научились фальсифицировать значение теста на беременность с помощью двух перемычек._

_Как показала практика, мало кто осведомлен о том, как должен выглядеть экран положительного теста. Поэтому, в принципе, предложенного варианта фальсификации может быть достаточно._

{% embed url="https://dc7495.org/there-reverse-engineering-more-fun-than-btplg-more-useful-than-stm/" %}

\_\_

