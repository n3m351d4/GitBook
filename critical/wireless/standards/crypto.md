---
description: >-
  3.2 Реализация макета безопасной системы радиоуправления с использованием
  криптографического сопроцессора
cover: >-
  https://images.unsplash.com/photo-1592919347498-69564e361791?crop=entropy&cs=srgb&fm=jpg&ixid=MnwxOTcwMjR8MHwxfHNlYXJjaHw0fHx3aXJlbGVzc3xlbnwwfHx8fDE2MzY0NzA2NzY&ixlib=rb-1.2.1&q=85
coverY: 0
---

# 3.2 Реализация макета безопасной системы радиоуправления

Большинство каналов связи открыты для доступа любым устройствам в радиусе своего действия. Беспроводной сигнал, передающийся по воздуху, может прослушать и попытаться перехватить злоумышленник, записать выдать себя за легитимного пользователя.

С учетом рассмотренных выше атак на системы радиоуправления далее будет рассмотрен пример системы радиоуправления, устойчивой к атакам локальных и удаленных злоумышленников, за исключением полностью удаленных злоумышленников.

Описываемый далее макет применим для интеграции в системы радиоуправления любой сложности и использует криптографические методы защиты информации, используя цифровую подпись ECC и криптографический сопроцессор.

**Сопроцессор** — специализированный процессор, расширяющий возможности центрального процессора компьютерной системы, но оформленный как отдельный функциональный модуль. Физически сопроцессор может быть отдельной микросхемой или может быть встроен в центральный процессор. Безопасность, в особенности сетевая безопасность, является еще одной областью, в которой широко используются сопроцессоры. Когда между клиентом и сервером устанавливается соединение, обычно требуется их взаимная аутентификация. По установленному таким образом безопасному (шифрованному) соединению можно передавать данные, не беспокоясь о вмешательстве злоумышленников для прослушивания линии передачи радиоданных. Проблема использования криптографических сопроцессоров на данный момент заключается в том, что безопасность обеспечивается средствами криптографии, а эта область требует весьма объемных вычислений. В криптографии сейчас рассмотрены два основных подхода к защите данных: шифрование с секретным ключом и шифрование с открытым ключом. Первый основан на очень тщательном перемешивании битов. В основе второго подхода лежит умножение и возведение в степень больших чисел (1024-разрядных), что требует исключительно больших временных затрат, что является недопустимым в случае внедрения в системы реального времени.

**Шифрование с закрытым ключом** основано на том, что доступ к ключу имеет только авторизованный персонал. Этот ключ должен держаться в секрете. Если конфиденциальность не соблюдается, посторонний сможет получить несанкционированный доступ к зашифрованной информации. Наиболее широко используемым алгоритмом с закрытым ключом является стандарт Data Encryption Standard (DES). Этот алгоритм, разработанный компанией IBM в семидесятых годах прошлого века, принят в качестве американского стандарта для коммерческих и несекретных правительственных коммуникаций. Современные скорости вычислений на порядок превышают скорости вычислений в семидесятых годах, поэтому алгоритм DES считается устаревшим как минимум с 1998 года. Другие известные системы шифрования с закрытым ключом — это RC2, RC4, RC5, тройной DES (triple DES) и IDEA. Тройной DES-алгоритм обеспечивает достаточную степень защиты. Этот алгоритм использует тот же метод шифрования, что и DES, но применяет его трижды, используя при этом до трех разных ключей. Открытый текст шифруется с использованием первого ключа, дешифруется при помощи второго ключа, а затем шифруется с применением третьего ключа. Явный недостаток алгоритмов с закрытым ключом состоит в том, что для отправки кому-то защищенного сообщения необходимо располагать безопасным способом передачи этому лицу закрытого ключа.

**Шифрование с открытым ключом** базируется на двух различных ключах — открытом и закрытом. Открытый ключ используется для шифрования сообщений, закрытый — для их дешифрования. Преимущество этого подхода состоит в том, что, как следует из его названия, открытый ключ можно свободно распространять. Любой человек, которому вы передали свой открытый ключ, может отправить вам защищенное сообщение. Но поскольку закрытым ключом обладаете только вы, только вы и сможете дешифровать сообщение. Наиболее известный алгоритм с открытым ключом — это алгоритм RSA, который был разработан Ривестом, Шамиром и Адельманом в Мичиганском технологическом институте (MIT) и опубликован в 1978 году. Часто можно встретить гибридные системы. В таких системах алгоритм с открытым ключом применяется для передачи закрытого ключа, который используется для обмена данными до конца связи. Эта дополнительная сложность компенсируется тем, что алгоритмы с закрытым ключом работают на три порядка быстрее алгоритмов с открытым ключом. Многими компаниями выпущены криптографические сопроцессоры, позволяющие шифровать данные для их безопасной передачи и потом расшифровывать их. Зачастую они представляют собой карты расширения, вставляемые в PCI-разъем. Благодаря специальному аппаратному обеспечению, эти процессоры могут выполнять необходимые криптографические вычисления намного быстрее, чем центральный процессор.

## **3.2.1 Безопасная система радиоуправления**

Для реализации макета безопасной системы радиоуправления предполагается использовать цифровую подпись ECC вместе с криптографическим сопроцессором.

**Цифровые подписи** — это криптографический инструмент для подписи сообщений и проверки подписей сообщений с целью подтверждения подлинности цифровых сообщений или электронных документов. Цифровые подписи обеспечивают:

**- Аутентификация сообщения** - доказательство того, что определенный известный отправитель (владелец секретного ключа) создал и подписал сообщение.

**- Целостность сообщения** - доказательство того, что сообщение не было изменено после подписания.

**- Безотказность** - подписавшая сторона не может отрицать подписание документа после того, как подпись однажды создана.

**ECC** (Elliptic Curve Cryptography) – это метод криптографии с открытым ключом, основанный на использовании эллиптических кривых над конечными полями. Самым главным отличием ECC от RSA является размер ключа по сравнению с криптографической стойкостью. ECC способен обеспечить ту же самую криптостойкость, что и RSA-система, но с ключами гораздо меньшего размера. К примеру, 256-битный ECC-ключ эквивалентен 3072-битным ключам RSA (которые на 50% длиннее, чем 2048-битные ключи, используемые сегодня). Наконец, самые защищенные симметричные алгоритмы, применяемые в TLS (например, AES), используют как минимум 128-битные ключи, вследствие чего переход к асимметричным ключам выглядит наиболее рациональным шагом.

Небольшой размер ключей делает ECC идеальным выбором для устройств с ограниченными ресурсами хранения или обработки данных, которые все чаще встречаются в сфере IoT, поэтому для создания макета будет использован именно этот алгоритм.

Полный цикл передачи управляющего сигнала должен быть следующим:

1\. Пользователь нажимает кнопку на пульте дистанционного управления.

2\. Пульт дистанционного управления запрашивает токен.

3\. Ведомое устройство генерирует случайный токен размером 32 байта.

4\. Ведомое устройство отправляет токен пульту дистанционного управления.

5\. Пульт дистанционного управления создает цифровую подпись ECC с использованием токена и своего уникального закрытого ключа (рисунок 7).

6\. Пульт дистанционного отправляет цифровую подпись ведомому устройству.

7\. Ведомое устройство проверяет цифровую подпись с помощью открытого ключа.

8\. При успешной верификации цифровой подписи, ведомое устройство совершает действие, соответствующее кнопке, нажатой на пульте дистанционного управления.

Данный алгоритм является безопасным, так как создать действительную копию цифровой подписи можно лишь имея доступ к криптографическому сопроцессору пульта дистанционного управления. Это связано с тем, что закрытый ключ генерируется случайным образом во время настройки и никогда не покидает используемой интегральной микросхемы. В отсутствии оборудования непосредственно используемого в подобной системе дистанционного управления создать требуемую цифровую подпись - невозможно.

Так как ведомое устройство каждый раз создает новый случайный токен для каждого запроса, позволяет предотвратить атаки типа «человек посередине» и атаки на плавающие коды, так же как атаки методом повторения ранее записанного радиосигнала и атаки путем внедрения команд в радиопередачу.

![Рисунок 7 Схема цифровой подписи](https://images.boosty.to/image/714bcb3f-e616-4084-867e-b0ce8dcdcdee?change\_time=1636475944\&mw=1090)

Цифровые подписи отличаются от КАС (кодов аутентификации сообщений), поскольку MAC создаются и проверяются одним и тем же секретным ключом с использованием симметричного алгоритма, а цифровые подписи создаются ключом подписи и проверяются другим ключом проверки, соответствующим подписи, ключ с использованием асимметричного алгоритма. И подписи, и коды КAС обеспечивают аутентификацию и целостность сообщений.

## **3.2.2 Аппаратное обеспечение**

Для создания макета безопасной системы радиоуправления требуется два отдельных электронных устройства. Одно устройство будет представлять собой пульт дистанционного управления, а второе – приемным устройством целевого оборудования.Структурно, пульт дистанционного управления и приемное устройство должны включать в себя следующие элементы:· Радиопередающий микроконтроллерный модуль, например SparkFun Pro RF - LoRa, 915MHz (SAMD21).· Антенна· Криптографический сопроцессор для создания цифровой подписи ECC, такой как Cryptographic Co-Processor ATECC508A (рисунок 8).

![Рисунок 8. Модуль криптографического сопроцессора](<../../../.gitbook/assets/image (323).png>)

Криптографический сопроцессор ATECC508A позволяет добавить надежную аутентификацию любому устройству Интернета вещей или встраиваемой системе. ATECC508A поддерживает множество криптографических процессов, включая:

· Создание и безопасное хранение уникальных пар асимметричных ключей на основе криптографии на основе эллиптических кривых (FIPS186 - 3).

· Создание и проверка 64-байтовых цифровых подписей (из 32-байтовых данных сообщения).

· Создание секретного ключа с помощью алгоритма Диффи-Хеллмана с эллиптической кривой.

·  Использование протокола на основе хэшей алгоритма SHA-256.

· Высококачественное создание случайных чисел FIPS.

В ATECC508A встроена память EEPROM размером 10 КБ, которую можно использовать для хранения ключей, сертификатов, данных и конфигураций безопасности. Доступ к разделам памяти может быть ограничен, а конфигурация заблокирована для предотвращения изменений. Каждый ATECC508A поставляется с уникальным 72-битным серийным номером и включает несколько функций безопасности для предотвращения физических атак на само устройство или логических атак на данные, передаваемые между устройствами.

Недостатками криптографического сопроцессора ATECC508A является то, что его можно настроить единожды до того, как он будет заблокирован для внесения в него изменений, он не поддерживает шифрование и дешифрование данных, но, в свою очередь он может выполнять множество процессов криптографической аутентификации, таких как создание безопасного закрытого ключа, безопасное хранение ключей, а также создание и проверка цифровой подписи.

## **3.2.3 Программное обеспечение**

Для создания макета безопасной системы радиоуправления потребуется написание двух программ для используемых раздельных электронных радиопередающих устройств. Описанные далее программы были созданы с использованием библиотек с открытым исходным кодом:

· SparkFun\_ATECCX08a\_Arduino\_Library (https://github.com/sparkfun/SparkFun\_ATECCX08a\_Arduino\_Library)

· SparkFun Qwiic Relay Arduino Library Github Repo (https://github.com/sparkfun/SparkFun\_Qwiic\_Relay\_Arduino\_Library)

· Radiohead Arduino Library (https://github.com/PaulStoffregen/RadioHead)

### **Программа пульта дистанционного управления (Приложение 1)**

Большую часть времени выполняется код внутри функции setup(). Такой подход позволяет сократить энергопотребление и запитывать передатчик пульта дистанционного управления только при нажатии на кнопку.После настройки радиомодуля и криптографического сопроцессора в конце выполнения функции конце setup() происходит:

· Запуск цикла передачи управляющего сигнала

· Прием 64 битного токена

· Создание цифровой подписи ECC

· Отправка цифровой подписи ведомому устройству

### **Программа ведомого устройства (Приложение 2)**

Программа ведомого устройства частично схожа с программой пульта дистанционного управления. Внутри своего основного цикла программа выполняет следующие действия:

· Слушает входящие сообщения.

· При получении заранее определенного сообщения создает новый случайный токен и отправляет его пульту дистанционного управления

· Слушает входящие сообщения на предмет получения цифровой подписи

· Получает 64 байтовую цифровую подпись

· Проверяет цифровую подпись

· При совпадении всех данных переключает реле ведомого устройства

· При несовпадении требуемых данных уничтожает сгенерированный случайный токен, что защищает устройство от атак методом повторения записанного ранее сигнала.
