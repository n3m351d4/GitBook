---
description: 2022. 2.2 Моделирование атак и поиск уязвимостей радио протоколов
cover: >-
  https://images.unsplash.com/photo-1592919347498-69564e361791?crop=entropy&cs=srgb&fm=jpg&ixid=MnwxOTcwMjR8MHwxfHNlYXJjaHw0fHx3aXJlbGVzc3xlbnwwfHx8fDE2MzY0NzA2NzY&ixlib=rb-1.2.1&q=85
coverY: 0
---

# 2.2 Моделирование атак и поиск уязвимостей радио протоколов

Следует отметить следующие типовые уязвимости радио протоколов (таблица 3), наиболее часто выявляемых путем анализа, реинжиниринга и тестирования радио протоколов.

| **Вид атаки** | **Шаблон уязвимости**                             | **Описание**                                                                                                                                | **Сложность исправления уязвимости**                                                                                                                                                                                                               |
| ------------- | ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1, 2          | Отсутствие плавающего кода                        | Передающиеся пакеты имеют статичную структуру, любые перехваченные команды будут действительны для будущего применения.                     | Разработка исправления уязвимости – проста. Внедрение исправления уязвимости не просто, так как множество устройств уже установлены и не всегда легко доступны.                                                                                    |
| 1, 2, 3, 4    | Слабая или отсутствующая криптографическая защита | Обмен данными между, передатчиком и приемником, не защищен, слабо обфусцирован, либо является предсказуемым                                 | Разработка исправления уязвимости – проста, но при исправлении разработчики могут столкнуться с тем, что, если используемое ими оборудование не поддерживает криптографические решения, может потребоваться изменение аппаратного решения в целом. |
| 5             | Отсутствие защиты программного обеспечения        | Программное обеспечение, используемое для загрузки прошивки в передатчик и приемник может быть подвергнуто несанкционированной модификации. | Разработка исправления уязвимости – проста, поставщикам оборудования требуется внедрить в программное обеспечение соответствующий контроль доступа                                                                                                 |

**Примечания:**

1 Атака повторного воспроизведения

1 Отказ в обслуживании

2 Внедрение команд

3 Вредоносное сопряжение

5 Внедрение вредоносного кода

Для изучения радиосигналов может быть использован метод черного ящика, при применении которого рассматривается исключительно радиочастотный сигнал, передаваемый по воздуху. В некоторых случаях во время лабораторных испытаний применим подход серого ящика – подключение контактов микроконтроллера к осциллографу, для наблюдения соотношения формы радиоволны, зафиксированной с помощью радиоприемника (SDR), с сигналом, отправляемым микроконтроллером.

Метод черного ящика – является достаточно сложным подходом для изучения безопасности радио протоколов, но он максимально приближен к реальности и представляет собой возможности злоумышленника с ограниченными ресурсами и ограниченными знаниями о целевых устройствах \[11]. 

## 2.2.1 Моделирование атаки методом повторного воспроизведения сигнала <a href="#_toc73876317" id="_toc73876317"></a>

Для тестирования устройств удаленного управления на уязвимость к атакам методом повторного воспроизведения следует записать радиопередачи команд, отправляемых по нажатию соответствующих кнопок, таких как: пуск и кнопок, соответствующих, например, одному из направлений движения управляемого устройства.

Воспроизводя эти команды по отдельности, можно уточнить следующие вопросы:

• Реализует ли целевое устройство механизмы безопасности, такие как скользящий код.

• Может ли злоумышленник может принудительно запустить систему при отключении питания.

• Кодируется ли команда экстренной остановки. Эта информация полезна для реализации отказа в обслуживании.

Так как мощность радиосигнала является единственным ограничивающим фактором для этой атаки, для ее реализации будет достаточно любого SDR-устройства с передающей антенной.

По этическим и юридическим причинам перед запуском атак желательно использовать анализатор спектра радиосигнала, например, такой как GQRX, чтобы убедиться, что никакие другие сигналы не были записаны (рисунок 5) (и, следовательно, воспроизведены) в пределах полосы пропускания (рисунок 6).

![Рисунок 5. Анализатор спектра радиосигнала.](<../../../.gitbook/assets/image (327) (1) (1).png>)

![Рисунок 6. Пример блок-схемы GNU Radio, составленной для записи сигнала.](<../../../.gitbook/assets/image (328) (1).png>)

## 2.2.2 Моделирование атаки методом внедрения команд <a href="#_toc63511856" id="_toc63511856"></a>

Моделирование этой атаки требует обратного проектирования протокола как на физическом уровне – уровне радиосигнала, так и на уровне приложения.

В общем случае для начала изучения радио протокола, как и в предыдущем примере используется запись радиосигнала, соответствующего различным командам, включая запуск, аварийную остановку и нажатие кнопок. Следует также обратить внимание, что передаваемые сигналы при длительном нажатии кнопок могут отличаться от сигналов, передаваемых при кратковременных нажатиях. Затем, необходимо изучить формы записанных сигналов, для того чтобы определить соответствующие им алгоритмы демодуляции. С этой целью можно использовать любую доступную документацию, и программное обеспечение «Universal Radio Hacker» для изучения формы радиосигнала. В том случае, если сигнал использует какие-либо смешанные формы модуляции, не поддерживаемые доступным программным обеспечением, существует возможность создания демодулятора в программном обеспечении GNU Radio, описанном ранее.

Необходимо помнить, что документация, относящаяся к конкретным радиоприёмным и радиопередающим устройствам, может быть устаревшей и вводить в заблуждение, так как радиопередающие устройства могут претерпевать несколько модификаций в течении времени своего производства, но не всегда эти изменения отражаются в соответствующих руководствах пользователя. Это говорит о том, что помимо изучения документации, несомненно, надо ориентировать на практические результаты анализа радиопередающего устройства.

Из технической документации и практического анализа радиопередающего устройства необходимо определить следующие параметры:

· Диапазон рабочих частот устройства;

· Тип модуляции;

· Длину, либо наличие идентификационного кода;

· Расстояние между радиоканалами (разнос);

· Использование либо отсутствие кода Хэмминга;

· Устройство реализующие кодирование – микроконтроллер либо передающий модуль;

· Основные элементы электронной схемы радиопередающего устройства – в некоторых случаях можно столкнуться с тем, что необходимые для изучения микросхемы могут быть залиты компаундом для защиты от обратной разработки, а передающие модули – закрыты металлическим крышками, для наилучшего охлаждения;

· Отладочные интерфейсы – при наличии на печатной плате целевого устройства, отладочные интерфейсы могут дать дополнительную информацию о работе радиоустройства.

В том случае, если кодирование информации осуществляется при помощи микроконтроллера, а модуль передатчика осуществляет исключительно передачу данных, существует возможность подключения логического анализатора непосредственно к выводам микроконтроллера, отвечающим за передачу данных к модулю передатчика для последующего изучения передаваемых данных и сопоставлением их с записанным ранее радиосигналом. Полученные данные будут полезны для декодирования и обратного проектирования структуры передаваемых данных и алгоритмов генерации контрольных сумм пакетов данных.

При обратном проектировании радио протоколов следует обращать внимание на закономерности в передаваемых радиопередатчиком пакетах данных – в таких закономерностях могут отражаться фиксированные идентификационные коды, слабая обфускация данных, программные ключи, поставляемые с устройствами, которые в дальнейшем можно использовать для генерации и отправки радиоуправляемому оборудованию произвольных команд.

## 2.2.3 Моделирование атаки отказ в обслуживании <a href="#_toc63511857" id="_toc63511857"></a>

Моделирование атаки типа отказ в обслуживании так же, является следствием анализа и обратной разработки протокола передачи радиоданных, описанных ранее. Такая атаки представляет собой бесконечный цикл передачи пакета, соответствующего команде аварийной остановки оборудования. В большинстве случаев, не смотря на наличие включенного легитимного радиопередатчика, пакеты команды аварийной остановки оборудования, передаваемые злонамеренным передатчиком, все равно принимаются и интерпретируются, в результате чего легитимные команды игнорируются приемником. \[12]

При попытке принудительного перезапуска оборудования, с использованием легитимного радиопередающего устройства, устройство включится, но, с учетом бесконечно передаваемых злонамеренных команд аварийной остановки во время подобной атаки – целевое устройство будет снова отключаться.

## 2.2.4 Моделирование вредоносного сопряжения <a href="#_toc63511858" id="_toc63511858"></a>

Для моделирования данной атаки, тестируемые приемник и передатчик должны быть включены и подключены к программаторам.

Далее, требуется инициировать сопряжение устройств, включив передатчик и нажимая кнопки в заданном порядке на подключаемом приемном устройстве в соответствии с его документацией. Во время этой процедуры сигнал может быть записал с помощью любого устройства SDR и воспроизведен на частоте целевого приемного устройства. После проведения данной операции целевое приемное устройство перестанет принимать команды от легитимного передатчика и начнет принимать команды от нового «злонамеренного» передатчика. Для возвращения системы в исходное состояние потребуется провести процедуру сопряжения заново с легитимным передатчиком в соответствии с его документацией.

Изучив протокол, используемый для сопряжения удаленного устройства с радиопередатчика, стоит определить его структуру и наличие шифрования.

Используя атаку типа «отказ в обслуживании» в сочетании с внедрением команд, злоумышленник может препятствовать работе всех промышленных радиоуправляемых устройств на заводе, в порту или на строительной площадке и нанести серьезный ущерб.

Примечательно то, что несмотря на применяемые в некоторых случаях меры безопасности – существуют требования, чтобы приемное устройство был физически открыто для перевода в «режим сопряжения», в результате чего такая атака может быть реализована без доступа к приемнику. В таком случае злоумышленнику потребуется всего лишь перехватить один пакет радиоданных, из которого он сможет восстановить фиксированный код. Фиксированный код – это секрет, совместно используемый передатчиком и приемником. Таким образом, приемник и передатчик с одним и тем же кодом будут эффективно объединены в пару. После этого злоумышленник сможет запрограммировать новый передатчик, используя украденный код.

## 2.2.5 Моделирование удаленных атак и внедрения вредоносного кода <a href="#_toc63511859" id="_toc63511859"></a>

Чтобы проверить, можно ли перепрограммировать пульт дистанционного управления без согласия пользователя во время подключения к скомпрометированному компьютеру, необходимо получить копию программного обеспечения для программирования целевого радиопередающего устройства, а также, если это возможно, специальный ключ. \[13]

Для многих устройств все еще не существует защиты, например, аутентификации, от злонамеренного перепрограммирования. В результате чего, злоумышленник или вредоносная программа могут выполнять автоматическое злонамеренное перепрограммирование передающих устройств и реализовывать соответствующие атаки. Стоит отметить, что подобное программное обеспечение для программирования в основном работает с операционной системой Windows, а иногда только на Windows XP, которая является основной операционной системой, на которую нацелены массовые вредоносные программы и развитые устойчивые угрозы (APT).

Анализируя трафик программатора по кабелю, можно подтвердить или опровергнуть возможность злоумышленника внедрить вредоносный код в флэш-память, в то время, когда пульт дистанционного управления подключен к компьютеру (например, для обслуживания или настройки). Данная модель злоумышленника подразумевает, что злоумышленник имеет доступ к компьютеру.

В некоторых контроллерах предохранители JTAG перегорают для защиты от несанкционированного доступа в то время, как защита от стирания загрузчика не включена. При отсутствии аппаратной схемы защиты, пароль загрузчика можно перехватить с помощью кабеля программатора (адаптера UART TTL), используя Bus Pirate или логический анализатор.

Используя пароль загрузчика, полученный через кабель программатора, можно прочитать флэш-память устройства, изменить его настройки, обновить или извлечь прошивку для исследования. Также, используя пароль загрузчика можно внедрить в него вредоносный код, который, например, инициирует нештатное поведение целевого устройства после нажатия определенного количества кнопок.

Получив доступ к программному обеспечению для перепрограммирования радиопередатчиков промышленного оборудования, злоумышленник может осуществить атаку на целевое устройство. Злоумышленник может изменить пароль загрузчика и включить функцию массового стирания флэш-памяти, чтобы затруднить или даже сделать невозможным техническую экспертизу и расследование инцидента.
